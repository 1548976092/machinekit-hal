diff --git a/debian/.gitignore b/debian/.gitignore
index 57862d6..10b5bb4 100644
--- a/debian/.gitignore
+++ b/debian/.gitignore
@@ -1,9 +1,8 @@
 # files generated from debian/configure
 /control
-/rules
 /files
 /configure.cmdline
-/machinekit*.install
+/rules.include
 
 # generated by scripts/build_source_package
 /changelog
diff --git a/debian/configure b/debian/configure
index 6ab061b..126b09a 100755
--- a/debian/configure
+++ b/debian/configure
@@ -22,58 +22,18 @@ cd "$(dirname $0)"
 # re-run
 echo $0 $* > configure.cmdline
 
-rules_enable_threads() {
-    # enable thread flavors in debian/rules; e.g.
-    #    THREADS_POSIX = --with-posix
-    # ...unnecessary for control-only
-    if test -n "$MK_CROSS_BUILDER"; then
-        # Reduce file req'ts in mk-cross-builder
-        echo "debian/rules:  skip ${FLAVOR} config in mk-cross-builder" >&2
-        return
-    fi
-    FLAVOR=$1
-    FLAVOR_VAR=THREADS_$(echo $FLAVOR | tr 'a-z-' 'A-Z_')
-    sed -i rules \
-    -e "s/^${FLAVOR_VAR}[^_].*/${FLAVOR_VAR} = --with-${FLAVOR}/"
-    echo "debian/rules:  enabled ${FLAVOR} threads" >&2
-}
-
-do_posix() {
-    cat control.posix.in >> control
-    echo "debian/control:  added POSIX threads package" >&2
-    rules_enable_threads posix
-    HAVE_FLAVOR=true
-}
-
-do_rt-preempt() {
-    cat control.rt-preempt.in >> control
-    echo "debian/control:  added RT_PREEMPT threads package" >&2
-
-    rules_enable_threads rt-preempt
-    HAVE_FLAVOR=true
-}
-
-do_xenomai() {
-    cat control.xenomai.in >> control
-    echo "debian/control:  added xenomai threads package" >&2
-
-    # Be sure the -dev files only appear once
-    BUILD_DEPS+=", libxenomai-dev"
-    echo "debian/control:  added Xenomai (userland) threads package" \
-    "with Build-Depends:" >&2
-    echo "    libxenomai-dev" >&2
-    rules_enable_threads xenomai
-    HAVE_FLAVOR=true
-}
-
-## Set version for packages by altering changelog
-## Write new version info then prepend existing one, for use in changes file
-## Allows command line builds and builds outside of Travis environment to set meaningful version numbers
+## Set version for packages by altering changelog Write new version
+## info then prepend existing one, for use in changes file Allows
+## command line builds and builds outside of Travis environment to set
+## meaningful version numbers
 
 do_changelog() {
-    DISTRO_UC="$(echo $DISTRO_CODENAME | sed 's/^[[:space:]]*//g' | sed -e 's/\b\(.\)/\u\1/g')"
+    DISTRO_UC="$(echo $DISTRO_CODENAME | sed 's/^[[:space:]]*//g' |
+        sed -e 's/\b\(.\)/\u\1/g')"
     DISTRO_LC="$(echo $DISTRO_CODENAME | sed 's/^[[:space:]]*//g')"
-    MKVERSION="$(git show HEAD:VERSION | cut -d ' ' -f 1).$(git rev-list --count master)-1.git$(git rev-parse --short HEAD)~${DISTRO_LC}"
+    MKVERSION="$(git show HEAD:VERSION | cut -d ' ' -f 1).$(
+        git rev-list --count HEAD)-1.git$(
+        git rev-parse --short HEAD)~${DISTRO_LC}"
     COMMITTER="$(git show -s --pretty=%an $(git rev-parse --short HEAD))"
     EMAIL="$(git show -s --format='%ae' $(git rev-parse --short HEAD))"
 
@@ -92,30 +52,29 @@ EOF
     echo "New package version number added to changelog"
 }
 
-## Create source orig tarball in format required for creation of debian tarball and .dsc file
-## Allows non binary package builds from command line or outside Travis environment
+## Create source orig tarball in format required for creation of
+## debian tarball and .dsc file Allows non binary package builds from
+## command line or outside Travis environment
 
 do_source_tarball() {
-#version based on major version plus commit number only, without suffixed -1 or commit hash
-MK_VERSION="$(git show HEAD:VERSION | cut -d ' ' -f 1).$(git rev-list --count master)"
-
-OWD=$PWD
-cd ../
-git archive HEAD | bzip2 -z > ../machinekit_${MK_VERSION}.orig.tar.bz2
-echo "Source tarball created"
-cd $OWD
+    #version based on major version plus commit number only, without
+    #suffixed -1 or commit hash
+    MK_VERSION="$(git show HEAD:VERSION | cut -d ' ' -f 1).$(
+                      git rev-list --count HEAD)"
+    OWD=$PWD
+    cd ../
+    git archive HEAD | bzip2 -z > ../machinekit_${MK_VERSION}.orig.tar.bz2
+    echo "Source tarball created"
+    cd $OWD
 }
 
 usage() {
     {
     test -z "$1" || echo "$1"
     echo "Usage:  $0 [ arg ... ]"
-    echo "   arg:		function:"
-    echo "   -p		build POSIX threads"
-    echo "   -r		build RT_PREEMPT threads"
-    echo "   -x		build Xenomai threads"
-    echo "   -c		rewrite changelog to set package version from git commit"
-    echo "   -s		create source tarball for non binary package builds"
+    echo "   arg:    function:"
+    echo "   -c      rewrite changelog to set package version from git commit"
+    echo "   -s      create source tarball for non binary package builds"
     } >&2
     exit 1
 }
@@ -132,6 +91,7 @@ test "$1" != --help || usage
 
 # set defaults
 BUILD_DEPS=  # List of Build-Depends
+DEPS=        # List of Depends
 HAVE_FLAVOR=false
 
 ## copy base templates into place
@@ -143,43 +103,44 @@ HAVE_FLAVOR=false
 ## however selecting python-imaging and python-imaging-tk in Stretch actually
 ## results in python-pil and python-pil.imagegtk being installed, so will probably completely backport soon.
 
-## Keep individual control files, so they can easily be amended as things change
-
-if [ "$DISTRO_CODENAME" == "stretch" ]; then
-    cp control.stretch.in control
-elif [ "$DISTRO_CODENAME" == "buster" ]; then
-    cp control.buster.in control
-elif [ "$DISTRO_CODENAME" == "sid" ]; then
-    cp control.sid.in control
-else
-    cp control.in control
-fi
+case "$DISTRO_CODENAME" in
+    buster)
+        : # Nothing
+        ;;
+    stretch|jessie|sid)
+        DEPS+=", python-gtksourceview2"
+        ;;
+    *)
+        DEPS+=", python-gtksourceview2"
+        ;;
+esac
+
+# Configure Xenomai threads
+configure_xenomai() {
+    if ! dpkg-query -W | grep -q libxenomai-dev; then
+        echo "Not configuring build for Xenomai (no libxenomai-dev package)" >&2
+        return
+    fi
 
-if test -z "$MK_CROSS_BUILDER"; then # Reduce file req'ts in mk-cross-builder
-    echo "debian/control:  copied base template" >&2
-    cp rules.in rules; chmod +x rules
-    echo "debian/rules:  copied base template" >&2
-    cp machinekit.install.in machinekit.install
-    echo "debian/machinekit.install.in:  copied base template" >&2
-fi
+    echo "debian/control:  Adding xenomai threads configuration" >&2
+    BUILD_DEPS+=", libxenomai-dev"
+    DEPS+=", xenomai-runtime"
+}
 
 # read command line options
-while getopts prxcsd?h ARG; do
+while getopts csh ARG; do
     case $ARG in
-    p) do_posix ;;
-    r) do_rt-preempt ;;
-    x) do_xenomai ;;
     c) do_changelog ;;  # set new changelog with package versions from git
     s) do_source_tarball ;; # create tarball for non binary builds
-    ?|h) usage ;;
+    h) usage ;;
     *) usage "Unknown arg: '-$ARG'" ;;
     esac
 done
 
 # Set control Build-Depends:
-sed -i control \
-    -e "s/@BUILD_DEPS@/${BUILD_DEPS}/"
+configure_xenomai
+cp control.in control
+sed >control <control.in \
+    -e "s/@BUILD_DEPS@/${BUILD_DEPS}/" \
+    -e "s/@DEPS@/${DEPS}/"
 echo "debian/control:  add final Build-Depends: list" >&2
-
-# Warn if no flavor configured
-$HAVE_FLAVOR || usage "WARNING:  No thread flavors configured"
diff --git a/debian/control.buster.in b/debian/control.buster.in
deleted file mode 100644
index e601665..0000000
--- a/debian/control.buster.in
+++ /dev/null
@@ -1,60 +0,0 @@
-Source: machinekit
-Section: misc
-Priority: extra
-Maintainer: John Morris <john@dovetail-automata.com>
-Build-Depends: debhelper (>= 6),
-    autoconf (>= 2.63), automake, libboost-python-dev, libgl1-mesa-dev,
-    libglu1-mesa-dev, libgtk2.0-dev, libmodbus-dev (>= 3.0), libudev-dev,
-    libncurses-dev, libreadline-dev, libusb-1.0-0-dev, libxmu-dev,
-    libxmu-headers, python (>= 2.6.6), python-dev (>= 2.6.6),
-    cython (>= 0.19), dh-python,
-    pkg-config, psmisc, python-tk, libxaw7-dev, libboost-serialization-dev,
-    libzmq3-dev (>= 4.0.4), libczmq-dev (>= 4.0.2), libjansson-dev (>= 2.5),
-    libwebsockets-dev (>= 1.2.2),
-    python-zmq (>= 14.0.1), procps,
-    liburiparser-dev, libssl-dev, python-setuptools,
-    uuid-dev, uuid-runtime, libavahi-client-dev,
-    libprotobuf-dev (>= 2.4.1), protobuf-compiler (>= 2.4.1),
-    python-protobuf (>= 2.4.1), libprotoc-dev (>= 2.4.1),
-    python-simplejson, libtk-img, libboost-thread-dev,
-    python-pyftpdlib, tcl8.6-dev, tk8.6-dev, libcgroup-dev @BUILD_DEPS@
-Standards-Version: 2.1.0
-
-#########################################################################
-## not built any more, components of it are in flavour packages
-##
-#Package: machinekit-dev
-#Architecture: any
-#Depends: make, g++, tcl8.6, tk8.6,
-#    ${shlibs:Depends}, ${misc:Depends},
-#    machinekit (= ${binary:Version}),
-#    yapps2-runtime
-#Section: libs
-#Description: PC based motion controller for real-time Linux
-# Machinekit is the next-generation Enhanced Machine Controller which
-# provides motion control for CNC machine tools and robotic
-# applications (milling, cutting, routing, etc.).
-# .
-# This package includes files needed to build new realtime components and
-# alternate front-ends for machinekit
-#########################################################################
-
-Package: machinekit
-Breaks: linuxcnc
-Replaces: linuxcnc
-Architecture: any
-Depends: ${shlibs:Depends}, machinekit-rt-threads, tcl8.6, tk8.6,
-    bwidget (>= 1.7), libtk-img (>=1.13),
-    ${python:Depends}, ${misc:Depends},
-    python-tk, python-imaging, python-imaging-tk,
-    python-gnome2, python-glade2,
-    python-numpy,
-    python-vte, python-xlib, python-gtkglext1, python-configobj,
-    python-zmq, python-protobuf (>= 2.4.1),
-    python-avahi, python-simplejson, python-pyftpdlib,
-    python-pydot, xdot, python-gst-1.0,
-    tclreadline, bc, procps, psmisc, uuid-runtime
-Description: PC based motion controller for real-time Linux
- Machinekit is the next-generation Enhanced Machine Controller which
- provides motion control for CNC machine tools and robotic
- applications (milling, cutting, routing, etc.).
diff --git a/debian/control.in b/debian/control.in
index 502aa51..5722279 100644
--- a/debian/control.in
+++ b/debian/control.in
@@ -20,25 +20,6 @@ Build-Depends: debhelper (>= 6),
     python-pyftpdlib, tcl8.6-dev, tk8.6-dev, libcgroup-dev @BUILD_DEPS@
 Standards-Version: 2.1.0
 
-#########################################################################
-## not built any more, components of it are in flavour packages
-##
-#Package: machinekit-dev
-#Architecture: any
-#Depends: make, g++, tcl8.6, tk8.6,
-#    ${shlibs:Depends}, ${misc:Depends},
-#    machinekit (= ${binary:Version}),
-#    yapps2-runtime
-#Section: libs
-#Description: PC based motion controller for real-time Linux
-# Machinekit is the next-generation Enhanced Machine Controller which
-# provides motion control for CNC machine tools and robotic
-# applications (milling, cutting, routing, etc.).
-# .
-# This package includes files needed to build new realtime components and
-# alternate front-ends for machinekit
-#########################################################################
-
 Package: machinekit
 Breaks: linuxcnc
 Replaces: linuxcnc
@@ -54,8 +35,26 @@ Depends: ${shlibs:Depends}, machinekit-rt-threads, tcl8.6, tk8.6,
     python-avahi, python-simplejson, python-pyftpdlib,
     python-pydot, xdot,
     tclreadline, bc, procps, psmisc, cgroup-tools,
-    python-gst0.10, uuid-runtime
+    python-gst-1.0 | python-gst0.10,
+    python-imaging | python-pil,
+    python-imaging-tk | python-pil.imagegtk,
+    uuid-runtime @DEPS@
+Description: PC based motion controller for real-time Linux
+ Machinekit is the next-generation Enhanced Machine Controller which
+ provides motion control for CNC machine tools and robotic
+ applications (milling, cutting, routing, etc.).
+
+Package: machinekit-dev
+Architecture: any
+Depends: make, g++, tcl8.6, tk8.6,
+   ${shlibs:Depends}, ${misc:Depends},
+   machinekit (= ${binary:Version}),
+   yapps2-runtime
+Section: libs
 Description: PC based motion controller for real-time Linux
  Machinekit is the next-generation Enhanced Machine Controller which
  provides motion control for CNC machine tools and robotic
  applications (milling, cutting, routing, etc.).
+ .
+ This package includes files needed to build new realtime components and
+ alternate front-ends for machinekit
diff --git a/debian/control.posix.in b/debian/control.posix.in
deleted file mode 100644
index 2966087..0000000
--- a/debian/control.posix.in
+++ /dev/null
@@ -1,14 +0,0 @@
-
-Package: machinekit-posix
-Architecture: any
-Depends: machinekit (= ${binary:Version}), ${shlibs:Depends}, yapps2-runtime
-Provides:  machinekit-rt-threads
-Breaks: machinekit-dev
-Enhances: machinekit
-Description: PC based motion controller for real-time Linux
- Machinekit is the next-generation Enhanced Machine Controller which
- provides motion control for CNC machine tools and robotic
- applications (milling, cutting, routing, etc.).
- .
- This package provides components and drivers that run on a non-realtime
- (Posix) system.
diff --git a/debian/control.rt-preempt.in b/debian/control.rt-preempt.in
deleted file mode 100644
index e77df33..0000000
--- a/debian/control.rt-preempt.in
+++ /dev/null
@@ -1,18 +0,0 @@
-
-Package: machinekit-rt-preempt
-Architecture: any
-Depends: machinekit (= ${binary:Version}), ${shlibs:Depends}, yapps2-runtime,
-# These Debian-style RT_PREEMPT package names are restricted by
-# architecture; ARM arch SOCs are all incompatible, so this can't be
-# easily done for ARM.
- linux-image-rt-686-pae [i386], linux-image-rt-amd64 [amd64]
-Provides:  machinekit-rt-threads
-Suggests: hostmot2-firmware-all [!armhf]
-Breaks: machinekit-dev
-Enhances: machinekit
-Description: PC based motion controller for real-time Linux
- Machinekit is the next-generation Enhanced Machine Controller which
- provides motion control for CNC machine tools and robotic
- applications (milling, cutting, routing, etc.).
- .
- This package provides components and drivers that run on an RT-Preempt system.
diff --git a/debian/control.sid.in b/debian/control.sid.in
deleted file mode 100644
index a066976..0000000
--- a/debian/control.sid.in
+++ /dev/null
@@ -1,60 +0,0 @@
-Source: machinekit
-Section: misc
-Priority: extra
-Maintainer: John Morris <john@dovetail-automata.com>
-Build-Depends: debhelper (>= 6),
-    autoconf (>= 2.63), automake, libboost-python-dev, libgl1-mesa-dev,
-    libglu1-mesa-dev, libgtk2.0-dev, libmodbus-dev (>= 3.0), libudev-dev,
-    libncurses-dev, libreadline-dev, libusb-1.0-0-dev, libxmu-dev,
-    libxmu-headers, python (>= 2.6.6), python-dev (>= 2.6.6),
-    cython (>= 0.19), dh-python,
-    pkg-config, psmisc, python-tk, libxaw7-dev, libboost-serialization-dev,
-    libzmq3-dev (>= 4.0.4), libczmq-dev (>= 4.0.2), libjansson-dev (>= 2.5),
-    libwebsockets-dev (>= 1.2.2),
-    python-zmq (>= 14.0.1), procps,
-    liburiparser-dev, libssl-dev, python-setuptools,
-    uuid-dev, uuid-runtime, libavahi-client-dev,
-    libprotobuf-dev (>= 2.4.1), protobuf-compiler (>= 2.4.1),
-    python-protobuf (>= 2.4.1), libprotoc-dev (>= 2.4.1),
-    python-simplejson, libtk-img, libboost-thread-dev,
-    python-pyftpdlib, tcl8.6-dev, tk8.6-dev @BUILD_DEPS@
-Standards-Version: 2.1.0
-
-#########################################################################
-## not built any more, components of it are in flavour packages
-##
-#Package: machinekit-dev
-#Architecture: any
-#Depends: make, g++, tcl8.6, tk8.6,
-#    ${shlibs:Depends}, ${misc:Depends},
-#    machinekit (= ${binary:Version}),
-#    yapps2-runtime
-#Section: libs
-#Description: PC based motion controller for real-time Linux
-# Machinekit is the next-generation Enhanced Machine Controller which
-# provides motion control for CNC machine tools and robotic
-# applications (milling, cutting, routing, etc.).
-# .
-# This package includes files needed to build new realtime components and
-# alternate front-ends for machinekit
-#########################################################################
-
-Package: machinekit
-Breaks: linuxcnc
-Replaces: linuxcnc
-Architecture: any
-Depends: ${shlibs:Depends}, machinekit-rt-threads, tcl8.6, tk8.6,
-    bwidget (>= 1.7), libtk-img (>=1.13),
-    ${python:Depends}, ${misc:Depends},
-    python-tk, python-pil, python-pil.imagetk,
-    python-gnome2, python-glade2,
-    python-numpy,
-    python-vte, python-xlib, python-gtkglext1, python-configobj,
-    python-zmq, python-protobuf (>= 2.4.1),
-    python-avahi, python-simplejson, python-pyftpdlib,
-    python-pydot, xdot, python-gst-1.0, python-gtksourceview2,
-    tclreadline, bc, procps, psmisc, uuid-runtime
-Description: PC based motion controller for real-time Linux
- Machinekit is the next-generation Enhanced Machine Controller which
- provides motion control for CNC machine tools and robotic
- applications (milling, cutting, routing, etc.).
diff --git a/debian/control.stretch.in b/debian/control.stretch.in
deleted file mode 100644
index 021a954..0000000
--- a/debian/control.stretch.in
+++ /dev/null
@@ -1,60 +0,0 @@
-Source: machinekit
-Section: misc
-Priority: extra
-Maintainer: John Morris <john@dovetail-automata.com>
-Build-Depends: debhelper (>= 6),
-    autoconf (>= 2.63), automake, libboost-python-dev, libgl1-mesa-dev,
-    libglu1-mesa-dev, libgtk2.0-dev, libmodbus-dev (>= 3.0), libudev-dev,
-    libncurses-dev, libreadline-dev, libusb-1.0-0-dev, libxmu-dev,
-    libxmu-headers, python (>= 2.6.6), python-dev (>= 2.6.6),
-    cython (>= 0.19), dh-python,
-    pkg-config, psmisc, python-tk, libxaw7-dev, libboost-serialization-dev,
-    libzmq3-dev (>= 4.0.4), libczmq-dev (>= 4.0.2), libjansson-dev (>= 2.5),
-    libwebsockets-dev (>= 1.2.2),
-    python-zmq (>= 14.0.1), procps,
-    liburiparser-dev, libssl-dev, python-setuptools,
-    uuid-dev, uuid-runtime, libavahi-client-dev,
-    libprotobuf-dev (>= 2.4.1), protobuf-compiler (>= 2.4.1),
-    python-protobuf (>= 2.4.1), libprotoc-dev (>= 2.4.1),
-    python-simplejson, libtk-img, libboost-thread-dev,
-    python-pyftpdlib, tcl8.6-dev, tk8.6-dev, libcgroup-dev @BUILD_DEPS@
-Standards-Version: 2.1.0
-
-#########################################################################
-## not built any more, components of it are in flavour packages
-##
-#Package: machinekit-dev
-#Architecture: any
-#Depends: make, g++, tcl8.6, tk8.6,
-#    ${shlibs:Depends}, ${misc:Depends},
-#    machinekit (= ${binary:Version}),
-#    yapps2-runtime
-#Section: libs
-#Description: PC based motion controller for real-time Linux
-# Machinekit is the next-generation Enhanced Machine Controller which
-# provides motion control for CNC machine tools and robotic
-# applications (milling, cutting, routing, etc.).
-# .
-# This package includes files needed to build new realtime components and
-# alternate front-ends for machinekit
-#########################################################################
-
-Package: machinekit
-Breaks: linuxcnc
-Replaces: linuxcnc
-Architecture: any
-Depends: ${shlibs:Depends}, machinekit-rt-threads, tcl8.6, tk8.6,
-    bwidget (>= 1.7), libtk-img (>=1.13),
-    ${python:Depends}, ${misc:Depends},
-    python-tk, python-imaging, python-imaging-tk,
-    python-gnome2, python-glade2,
-    python-numpy, python-gtksourceview2,
-    python-vte, python-xlib, python-gtkglext1, python-configobj,
-    python-zmq, python-protobuf (>= 2.4.1),
-    python-avahi, python-simplejson, python-pyftpdlib,
-    python-pydot, xdot, python-gst-1.0, python-gtksourceview2,
-    tclreadline, bc, procps, psmisc, uuid-runtime
-Description: PC based motion controller for real-time Linux
- Machinekit is the next-generation Enhanced Machine Controller which
- provides motion control for CNC machine tools and robotic
- applications (milling, cutting, routing, etc.).
diff --git a/debian/control.xenomai.in b/debian/control.xenomai.in
deleted file mode 100644
index 908d4cf..0000000
--- a/debian/control.xenomai.in
+++ /dev/null
@@ -1,16 +0,0 @@
-
-Package: machinekit-xenomai
-Architecture: any
-Depends: machinekit (= ${binary:Version}), ${shlibs:Depends}, yapps2-runtime,
-	xenomai-runtime
-Provides:  machinekit-rt-threads
-Recommends: hostmot2-firmware-all [!armhf]
-Breaks: machinekit-dev
-Enhances: machinekit
-Description: PC based motion controller for real-time Linux
- Machinekit is the next-generation Enhanced Machine Controller which
- provides motion control for CNC machine tools and robotic
- applications (milling, cutting, routing, etc.).
- .
- This package provides components and drivers that run on a Xenomai
- realtime system, with userspace threads.
diff --git a/debian/machinekit-dev.install b/debian/machinekit-dev.install
new file mode 100644
index 0000000..65cf441
--- /dev/null
+++ b/debian/machinekit-dev.install
@@ -0,0 +1,8 @@
+usr/include/linuxcnc/*.hh
+usr/include/linuxcnc/*.h
+usr/include/linuxcnc/userpci/*.h
+usr/lib/*.a
+usr/lib/*.so
+usr/bin/comp
+usr/share/linuxcnc/Makefile.modinc
+usr/share/linuxcnc/Makefile.inc
diff --git a/debian/machinekit-posix.install.in b/debian/machinekit-posix.install.in
deleted file mode 100644
index ec94d9a..0000000
--- a/debian/machinekit-posix.install.in
+++ /dev/null
@@ -1,11 +0,0 @@
-usr/lib/linuxcnc/posix/*.so
-usr/lib/linuxcnc/ulapi-posix.so
-usr/libexec/linuxcnc/rtapi_app_posix
-usr/include/linuxcnc/*.hh
-usr/include/linuxcnc/*.h
-usr/lib/*.a
-usr/lib/*.so
-usr/bin/comp
-usr/share/linuxcnc/Makefile.modinc
-usr/share/linuxcnc/Makefile.inc
-
diff --git a/debian/machinekit-rt-preempt.install.in b/debian/machinekit-rt-preempt.install.in
deleted file mode 100644
index 2333760..0000000
--- a/debian/machinekit-rt-preempt.install.in
+++ /dev/null
@@ -1,10 +0,0 @@
-usr/lib/linuxcnc/rt-preempt/*.so
-usr/lib/linuxcnc/ulapi-rt-preempt.so
-usr/libexec/linuxcnc/rtapi_app_rt-preempt
-usr/include/linuxcnc/*.hh
-usr/include/linuxcnc/*.h
-usr/lib/*.a
-usr/lib/*.so
-usr/bin/comp
-usr/share/linuxcnc/Makefile.modinc
-usr/share/linuxcnc/Makefile.inc
diff --git a/debian/machinekit-xenomai.install.in b/debian/machinekit-xenomai.install.in
deleted file mode 100644
index fd029e8..0000000
--- a/debian/machinekit-xenomai.install.in
+++ /dev/null
@@ -1,10 +0,0 @@
-usr/lib/linuxcnc/xenomai/*
-usr/lib/linuxcnc/ulapi-xenomai.so
-usr/libexec/linuxcnc/rtapi_app_xenomai
-usr/include/linuxcnc/*.hh
-usr/include/linuxcnc/*.h
-usr/lib/*.a
-usr/lib/*.so
-usr/bin/comp
-usr/share/linuxcnc/Makefile.modinc
-usr/share/linuxcnc/Makefile.inc
diff --git a/debian/machinekit.install b/debian/machinekit.install
new file mode 100644
index 0000000..d905911
--- /dev/null
+++ b/debian/machinekit.install
@@ -0,0 +1,43 @@
+etc/linuxcnc/*
+etc/rsyslog.d/linuxcnc.conf
+etc/security/limits.d/machinekit.conf
+etc/udev/rules.d/50-shmdrv.rules
+etc/X11/app-defaults/*
+usr/lib/*.so.*
+usr/lib/linuxcnc/*
+usr/lib/tcltk/linuxcnc
+usr/bin/*
+usr/lib/python*/*/*.py
+usr/lib/python*/*/*.so
+usr/lib/python*/*/*/*.py
+usr/lib/python*/*/gladevcp/*.glade
+usr/lib/python*/*/machinekit/*.so
+usr/lib/python*/*/machinetalk/protobuf/*.py
+usr/lib/python*/*/machinetalk/*.py
+usr/lib/python*/*/machinekit/nosetests/*.py
+usr/lib/python*/*/fdm/*.py
+usr/lib/python*/*/fdm/config/*.py
+usr/libexec/linuxcnc/pci_read
+usr/libexec/linuxcnc/pci_write
+usr/libexec/linuxcnc/inivar
+usr/libexec/linuxcnc/rtapi_msgd
+usr/libexec/linuxcnc/rtapi_app
+usr/share/axis/images/*
+usr/share/axis/tcl/*
+usr/share/glade3
+usr/share/doc/linuxcnc/axis_light_background
+usr/share/doc/linuxcnc/xlinuxcnc.asciidoc
+usr/share/doc/linuxcnc/tklinuxcnc.asciidoc
+usr/share/doc/linuxcnc/README.axis
+usr/share/linuxcnc/*
+usr/share/machinekit
+usr/share/linuxcnc/stepconf/*.glade
+usr/share/locale/*/LC_MESSAGES/*.mo
+usr/share/gtksourceview-2.0/
+usr/share/gscreen
+usr/share/gmoccapy
+usr/share/fdm
+usr/share/applications/*
+usr/share/desktop-directories/cnc.directory
+etc/modprobe.d/linuxcnc.conf
+etc/xdg/menus/applications-merged/cnc.menu
diff --git a/debian/machinekit.install.in b/debian/machinekit.install.in
deleted file mode 100644
index 149f7a6..0000000
--- a/debian/machinekit.install.in
+++ /dev/null
@@ -1,41 +0,0 @@
-etc/linuxcnc/*
-etc/rsyslog.d/linuxcnc.conf
-etc/security/limits.d/machinekit.conf
-etc/udev/rules.d/50-shmdrv.rules
-etc/X11/app-defaults/*
-usr/lib/*.so.*
-usr/lib/tcltk/linuxcnc
-usr/bin/*
-usr/lib/python*/*/*.py
-usr/lib/python*/*/*.so
-usr/lib/python*/*/*/*.py
-usr/lib/python*/*/gladevcp/*.glade
-usr/lib/python*/*/machinekit/*.so
-usr/lib/python*/*/machinetalk/protobuf/*.py
-usr/lib/python*/*/machinetalk/*.py
-usr/lib/python*/*/machinekit/nosetests/*.py
-usr/lib/python*/*/fdm/*.py
-usr/lib/python*/*/fdm/config/*.py
-usr/libexec/linuxcnc/pci_read
-usr/libexec/linuxcnc/pci_write
-usr/libexec/linuxcnc/inivar
-usr/libexec/linuxcnc/flavor
-usr/libexec/linuxcnc/rtapi_msgd
-usr/share/axis/images/*
-usr/share/axis/tcl/*
-usr/share/glade3
-usr/share/doc/linuxcnc/axis_light_background
-usr/share/doc/linuxcnc/xlinuxcnc.asciidoc
-usr/share/doc/linuxcnc/tklinuxcnc.asciidoc
-usr/share/doc/linuxcnc/README.axis
-usr/share/linuxcnc/*
-usr/share/linuxcnc/stepconf/*.glade
-usr/share/locale/*/LC_MESSAGES/*.mo
-usr/share/gtksourceview-2.0/
-usr/share/gscreen
-usr/share/gmoccapy
-usr/share/fdm
-usr/share/applications/*
-usr/share/desktop-directories/cnc.directory
-etc/modprobe.d/linuxcnc.conf
-etc/xdg/menus/applications-merged/cnc.menu
diff --git a/debian/machinekit.postinst b/debian/machinekit.postinst
index 449fafe..b301f32 100755
--- a/debian/machinekit.postinst
+++ b/debian/machinekit.postinst
@@ -21,40 +21,6 @@ chmod ugo+r /var/log/linuxcnc.log
 # restart the rsyslogd to start logging to /var/log/linuxcnc.conf 
 invoke-rc.d rsyslog restart
 
-# The rebranding from linuxcnc to machinekit is taken care of in src/configure for RIPs
-# /usr builds to package need it in postinst script
-# This  bit should not be needed, just belt and braces :)
-# Checking for / creating ~/machinekit dir now in linuxcnc script
-
-if [ -f "/usr/bin/linuxcnc" ]; then
-    if [ ! -f "/usr/bin/machinekit" ]; then
-	if [ ! -L "/usr/bin/machinekit" ]; then
-	    ln -s /usr/bin/linuxcnc /usr/bin/machinekit
-	    echo "Creating machinekit symlink"
-	fi
-    fi
-else
-    if [ -f "/usr/local/bin/linuxcnc" ]; then
-        if [ ! -f "/usr/local/bin/machinekit" ]; then
-	    if [ ! -L "/usr/local/bin/machinekit" ]; then
-		ln -s /usr/local/bin/linuxcnc /usr/local/bin/machinekit
-		echo "Creating machinekit symlink"
-	    fi
-        fi
-    fi
-fi
-
-# Until rebranded completely solve corner cases like this
-
-if [ -f "/usr/share/linuxcnc" ]; then
-    if [ ! -f "/usr/share/machinekit" ]; then
-	if [ ! -L "/usr/share/machinekit" ]; then
-	    ln -s /usr/share/linuxcnc /usr/share/machinekit
-	    echo "Creating machinekit symlink"
-	fi
-    fi
-fi
-
 ###############################################################################
 
 INIFILE=/etc/linuxcnc/machinekit.ini
diff --git a/debian/posix-postinst.add b/debian/posix-postinst.add
deleted file mode 100644
index 7fdefcb..0000000
--- a/debian/posix-postinst.add
+++ /dev/null
@@ -1,13 +0,0 @@
-
-# ensure the links do not pre-exist, from previous installs.
-# or user work-arounds,  which will produce error messages
-rm -f /usr/lib/linuxcnc/posix/pru_generic.bin
-rm -f /usr/lib/linuxcnc/posix/pru_generic.dbg
-rm -f /usr/lib/linuxcnc/posix/pru_decamux.bin
-rm -f /usr/lib/linuxcnc/posix/pru_decamux.dbg
-
-# make symlinks to BBB pru_*.*
-ln -sf /usr/lib/linuxcnc/prubin/pru_generic.bin /usr/lib/linuxcnc/posix/pru_generic.bin
-ln -sf /usr/lib/linuxcnc/prubin/pru_generic.dbg /usr/lib/linuxcnc/posix/pru_generic.dbg
-ln -sf /usr/lib/linuxcnc/prubin/pru_decamux.bin /usr/lib/linuxcnc/posix/pru_decamux.bin
-ln -sf /usr/lib/linuxcnc/prubin/pru_decamux.dbg /usr/lib/linuxcnc/posix/pru_decamux.dbg
diff --git a/debian/rt-preempt-postinst.add b/debian/rt-preempt-postinst.add
deleted file mode 100644
index 9eec2b6..0000000
--- a/debian/rt-preempt-postinst.add
+++ /dev/null
@@ -1,13 +0,0 @@
-
-# ensure the links do not pre-exist, from previous installs 
-# or user work-arounds,  which will produce error messages
-rm -f /usr/lib/linuxcnc/rt-preempt/pru_generic.bin
-rm -f /usr/lib/linuxcnc/rt-preempt/pru_generic.dbg
-rm -f /usr/lib/linuxcnc/rt-preempt/pru_decamux.bin
-rm -f /usr/lib/linuxcnc/rt-preempt/pru_decamux.dbg
-
-# make symlinks to BBB pru_*.*
-ln -sf /usr/lib/linuxcnc/prubin/pru_generic.bin /usr/lib/linuxcnc/rt-preempt/pru_generic.bin
-ln -sf /usr/lib/linuxcnc/prubin/pru_generic.dbg /usr/lib/linuxcnc/rt-preempt/pru_generic.dbg
-ln -sf /usr/lib/linuxcnc/prubin/pru_decamux.bin /usr/lib/linuxcnc/rt-preempt/pru_decamux.bin
-ln -sf /usr/lib/linuxcnc/prubin/pru_decamux.dbg /usr/lib/linuxcnc/rt-preempt/pru_decamux.dbg
diff --git a/debian/rules b/debian/rules
new file mode 100755
index 0000000..dd66c59
--- /dev/null
+++ b/debian/rules
@@ -0,0 +1,216 @@
+#!/usr/bin/make -f
+# Simple set of debian/rules that uses debhelper.
+# Based on an example by Joey Hess.
+# extended by Paul Corner, Alex Joni, Chris Radek, Jeff Epler, John
+# Morris (in cronological order)
+
+# Copyright (C) 2006 Jeff Epler
+#
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# When used to produce a debian package, this file is a script "used to
+# control compilation and installation of the executable"
+
+# For cross-compiling
+include /usr/share/dpkg/architecture.mk
+ifneq ($(DEB_BUILD_GNU_TYPE),$(DEB_HOST_GNU_TYPE))
+DEB_BUILD_OPTIONS += nocheck
+endif
+# Uncomment this to turn on verbose mode.
+#export DH_VERBOSE=1
+
+# dpkg-shlibdeps warning exclusions
+SHLIBDEPS_X :=  # add patterns here
+#
+# The name 'libtk8.6.so' can't be parsed by dpkg-shlibdeps, it seems:
+#     "can't extract name and version from library name 'libtk8.6.so'
+SHLIBDEPS_X += linuxcnc.so _togl.so
+#
+# libcanterp.so.0 and librs274.so.0: hack for now:  see
+# https://github.com/machinekit/machinekit/issues/324
+#     "symbol ... used by ... found in none of the libraries"
+SHLIBDEPS_X += libcanterp.so.0 librs274.so.0
+#
+# halmeter classicladder halscope link to $(GTK_LIBS), which includes
+# several libs that aren't used (but several that are needed)
+SHLIBDEPS_X += halmeter classicladder halscope
+#
+# mb2hal gs2_vfd hy_vfd link to libglib-2.0.so.0; similar to above
+SHLIBDEPS_X += mb2hal gs2_vfd hy_vfd
+
+# Cross-compile variables
+DEB_HOST_ARCH := $(shell dpkg-architecture -qDEB_HOST_ARCH)
+
+# Parallel make
+ifneq (,$(filter parallel=%,$(DEB_BUILD_OPTIONS)))
+    NUMJOBS = $(patsubst parallel=%,%,$(filter parallel=%,$(DEB_BUILD_OPTIONS)))
+    MAKEFLAGS += -j$(NUMJOBS)
+endif
+# Only set 'CC' if explicitly defined in environment; otherwise 'make'
+# chooses CC=cc and CXX=g++ for defaults
+ifneq ($(origin CC),default)
+    COMPILE_ENV += CC="$(CC)"
+endif
+ifneq ($(origin CXX),default)
+    COMPILE_ENV += CXX="$(CXX)"
+endif
+
+
+debian/control: debian/configure
+#	# if debian/configure has not been run, error out
+	if ! test -f debian/configure.cmdline; then \
+	    @echo "Please run debian/configure" \
+	        "to generate the debian/control file."; \
+	    false; \
+	fi
+	@echo rebuilding debian/control
+
+
+build: build-arch build-indep
+build-arch: build-stamp
+build-indep: build-stamp
+build-stamp: debian/control
+	dh_testdir
+
+# Add here commands to compile the package.
+	cd src && ./autogen.sh
+	cd src && env $(COMPILE_ENV) \
+	    ./configure --prefix=/usr \
+	    --build=$(DEB_BUILD_MULTIARCH) \
+	    --host=$(DEB_HOST_MULTIARCH) \
+	    --sysconfdir=/etc \
+	    --mandir=/usr/share/man \
+	    --enable-emcweb
+	cd src && $(MAKE) $(COMPILE_ENV) $(MAKEFLAGS) V=$(DH_VERBOSE)
+	touch build-stamp
+
+clean: debian/control
+	dh_testdir
+	dh_testroot
+	rm -f build-stamp
+
+#	# Only run configure if the tree looks dirty. Running
+#	# ./configure in qemu is expensive.
+ifneq ($(wildcard src/configure src/Makefile.inc),)
+	cd src && ./autogen.sh
+	cd src && env $(COMPILE_ENV) \
+	    ./configure --prefix=/usr \
+	    --build=$(DEB_BUILD_MULTIARCH) \
+	    --host=$(DEB_HOST_MULTIARCH) \
+	    --sysconfdir=/etc \
+	    --mandir=/usr/share/man \
+	    --enable-emcweb
+	cd src && $(MAKE) clean -s
+#	# Manually remove things left by './configure'
+	rm -f \
+	    lib/python/machinekit/config.py \
+	    lib/python/nf.py \
+	    scripts/check-build-vs-configure-sha \
+	    scripts/gen-rtapi.ini.sh \
+	    scripts/gen-rtapi.ini.sh.in \
+	    scripts/halrun \
+	    scripts/haltcl \
+	    scripts/linuxcnc \
+	    scripts/linuxcnc_var \
+	    scripts/linuxcncmkdesktop \
+	    scripts/machinekit.ini.tmpl \
+	    scripts/realtime \
+	    scripts/rip-environment \
+	    share/applications/linuxcnc-latency.desktop \
+	    share/applications/linuxcnc.desktop \
+	    share/desktop-directories/cnc.directory \
+	    share/menus/CNC.menu \
+	    src/aclocal.m4 \
+	    src/config.h \
+	    src/config.h.in \
+	    src/config.log \
+	    src/config.status \
+	    src/configure \
+	    src/machinekitcfg.py-tmp \
+	    src/Makefile.inc \
+	    src/Makefile.modinc \
+	    tcl/linuxcnc.tcl
+	rm -rf src/autom4te.cache etc
+
+endif
+
+#	# Remove package artifacts
+	dh_clean
+
+install: build
+	dh_testdir
+	dh_testroot
+	dh_prep
+	dh_installdirs
+# start the install
+	mkdir -p debian/tmp
+	(cd debian/extras && cp -a * ../tmp)
+	(cd src; export DESTDIR=`pwd`/../debian/tmp; $(MAKE) V=$(DH_VERBOSE) $@)
+	mkdir -p debian/tmp/usr/lib/linuxcnc/modules debian/tmp/usr/include/linuxcnc
+	cp lib/*.a debian/tmp/usr/lib
+	## if they weren't there we don't care if rm fails
+	rm -f debian/tmp/usr/share/applications/linuxcnc-usermanual*.desktop
+	rm -f debian/tmp/usr/share/applications/linuxcnc-halmanual*.desktop
+	rm -f debian/tmp/usr/share/applications/linuxcnc-integratormanual*.desktop
+	rm -f debian/tmp/usr/share/applications/linuxcnc-gettingstarted*.desktop
+	rm -f debian/tmp/usr/share/applications/linuxcnc-developer*.desktop
+
+	rm -rf debian/tmp/usr/share/doc/linuxcnc/html
+	rm -f debian/tmp/usr/share/linuxcnc/examples/sample-configs/*/*position*.txt
+	# update emcweb.hal
+	sed 's/#NC_FILES_DIR/NC_FILES_DIR/' -i debian/tmp/usr/share/linuxcnc/examples/sample-configs/sim/emcweb.ini
+
+ifneq (,$(wildcard debian/machinekit-*-kernel-*.install))
+	mkdir -p debian/tmp/etc/udev/rules.d
+	cp src/rtapi/shmdrv/shmdrv.rules \
+	    debian/tmp/etc/udev/rules.d/50-shmdrv.rules
+endif
+	mkdir -p debian/tmp/etc/security/limits.d
+	cp src/rtapi/shmdrv/limits.d-machinekit.conf \
+	    debian/tmp/etc/security/limits.d/machinekit.conf
+
+	mkdir -p debian/tmp/usr/lib/linuxcnc/prubin
+
+	dh_install --sourcedir=debian/tmp --fail-missing -Xusr/bin/pasm
+
+# Build architecture-independent files here.
+binary-indep: build install
+# We have nothing to do by default.
+
+# Build architecture-dependent files here.
+binary-arch: build install
+	dh_testdir
+	dh_testroot
+	dh_installchangelogs
+	dh_installexamples
+	dh_installman
+	dh_installmime
+	dh_link
+	dh_strip
+	dh_compress -X.pdf -X.txt -X.hal -X.ini -X.clp -X.var -X.nml \
+	    -X.tbl -X.xml -Xsample-configs
+	dh_fixperms -X/rtapi_app_
+	dh_python2 --ignore-shebangs --no-guessing-versions --no-ext-rename
+	dh_makeshlibs
+	dh_installdeb
+
+#	# delete files that should be in machinekit-<flavor> package
+	rm -f debian/machinekit/usr/bin/comp
+	rm -f debian/machinekit/usr/share/linuxcnc/Makefile.modinc
+	rm -f debian/machinekit/usr/share/linuxcnc/Makefile.inc
+
+	cat debian/machinekit/DEBIAN/shlibs debian/shlibs.pre > \
+	    debian/shlibs.local
+        #enable buster builds to work with problematic shlib deps in current packages
+	dh_shlibdeps --dpkg-shlibdeps-params=--ignore-missing-info \
+            $(foreach p, $(SHLIBDEPS_X), -X $(p))
+	dh_gencontrol
+
+	dh_md5sums
+	dh_builddeb
+
+binary: binary-indep binary-arch
+.PHONY: build clean binary-indep binary-arch binary install
diff --git a/debian/rules.in b/debian/rules.in
deleted file mode 100755
index 4103462..0000000
--- a/debian/rules.in
+++ /dev/null
@@ -1,251 +0,0 @@
-#!/usr/bin/make -f
-# Simple set of debian/rules that uses debhelper.
-# Based on an example by Joey Hess.
-# extended by Paul Corner, Alex Joni, Chris Radek, Jeff Epler, John
-# Morris (in cronological order)
-
-# Copyright (C) 2006 Jeff Epler
-#
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2 of the License, or
-# (at your option) any later version.
-#
-# When used to produce a debian package, this file is a script "used to
-# control compilation and installation of the executable"
-
-# For cross-compiling
-include /usr/share/dpkg/architecture.mk
-ifneq ($(DEB_BUILD_GNU_TYPE),$(DEB_HOST_GNU_TYPE))
-DEB_BUILD_OPTIONS += nocheck
-endif
-# Uncomment this to turn on verbose mode.
-#export DH_VERBOSE=1
-
-# dpkg-shlibdeps warning exclusions
-SHLIBDEPS_X :=  # add patterns here
-#
-# The name 'libtk8.6.so' can't be parsed by dpkg-shlibdeps, it seems:
-#     "can't extract name and version from library name 'libtk8.6.so'
-SHLIBDEPS_X += linuxcnc.so _togl.so
-#
-# libcanterp.so.0 and librs274.so.0: hack for now:  see
-# https://github.com/machinekit/machinekit/issues/324
-#     "symbol ... used by ... found in none of the libraries"
-SHLIBDEPS_X += libcanterp.so.0 librs274.so.0
-#
-# halmeter classicladder halscope link to $(GTK_LIBS), which includes
-# several libs that aren't used (but several that are needed)
-SHLIBDEPS_X += halmeter classicladder halscope
-
-# Enable/disable thread flavors; all flavors disabled by default
-THREADS_POSIX = --without-posix
-THREADS_RT_PREEMPT = --without-rt-preempt
-THREADS_XENOMAI = --without-xenomai
-
-# Kernel threads need a list of configured header source directories
-# for each architecture
-#
-# Multiples should be space-separated
-#
-DEB_HOST_ARCH := $(shell dpkg-architecture -qDEB_HOST_ARCH)
-
-# Parallel make
-ifneq (,$(filter parallel=%,$(DEB_BUILD_OPTIONS)))
-    NUMJOBS = $(patsubst parallel=%,%,$(filter parallel=%,$(DEB_BUILD_OPTIONS)))
-    MAKEFLAGS += -j$(NUMJOBS)
-endif
-# Only set 'CC' if explicitly defined in environment; otherwise 'make'
-# chooses CC=cc and CXX=g++ for defaults
-ifneq ($(origin CC),default)
-    COMPILE_ENV += CC="$(CC)"
-endif
-ifneq ($(origin CXX),default)
-    COMPILE_ENV += CXX="$(CXX)"
-endif
-
-
-debian/control: debian/configure
-#	# if debian/configure has not been run, error out
-	if ! test -f debian/configure.cmdline; then \
-	    @echo "Please run debian/configure" \
-	        "to generate the debian/control file."; \
-	    false; \
-	fi
-	@echo rebuilding debian/control
-
-
-build: build-arch build-indep
-build-arch: build-stamp
-build-indep: build-stamp
-build-stamp: debian/control
-	dh_testdir
-
-# Add here commands to compile the package.
-	cd src && ./autogen.sh
-	cd src && env $(COMPILE_ENV) \
-	    ./configure --prefix=/usr \
-	    --build=$(DEB_BUILD_MULTIARCH) \
-	    --host=$(DEB_HOST_MULTIARCH) \
-	    $(THREADS_POSIX) \
-	    $(THREADS_RT_PREEMPT) \
-	    $(THREADS_XENOMAI) \
-	    --sysconfdir=/etc \
-	    --mandir=/usr/share/man \
-	    --enable-emcweb
-	cd src && $(MAKE) $(COMPILE_ENV) $(MAKEFLAGS) V=$(DH_VERBOSE)
-	touch build-stamp
-
-clean: debian/control
-	dh_testdir
-	dh_testroot
-	rm -f build-stamp
-
-#	# Only run configure if the tree looks dirty. Running
-#	# ./configure in qemu is expensive.
-ifneq ($(wildcard src/configure src/Makefile.inc),)
-	cd src && ./autogen.sh
-	cd src && env $(COMPILE_ENV) \
-	    ./configure --prefix=/usr \
-	    --build=$(DEB_BUILD_MULTIARCH) \
-	    --host=$(DEB_HOST_MULTIARCH) \
-	    $(THREADS_POSIX) \
-	    $(THREADS_RT_PREEMPT) \
-	    $(THREADS_XENOMAI) \
-	    --sysconfdir=/etc \
-	    --mandir=/usr/share/man \
-	    --enable-emcweb
-	cd src && $(MAKE) clean -s
-#	# Manually remove things left by './configure'
-	rm -f \
-	    lib/python/machinekit/config.py \
-	    lib/python/nf.py \
-	    scripts/check-build-vs-configure-sha \
-	    scripts/gen-rtapi.ini.sh \
-	    scripts/gen-rtapi.ini.sh.in \
-	    scripts/halrun \
-	    scripts/haltcl \
-	    scripts/linuxcnc \
-	    scripts/linuxcnc_var \
-	    scripts/linuxcncmkdesktop \
-	    scripts/machinekit.ini.tmpl \
-	    scripts/realtime \
-	    scripts/rip-environment \
-	    share/applications/linuxcnc-latency.desktop \
-	    share/applications/linuxcnc.desktop \
-	    share/desktop-directories/cnc.directory \
-	    share/menus/CNC.menu \
-	    src/aclocal.m4 \
-	    src/config.h \
-	    src/config.h.in \
-	    src/config.log \
-	    src/config.status \
-	    src/configure \
-	    src/machinekitcfg.py-tmp \
-	    src/Makefile.inc \
-	    src/Makefile.modinc \
-	    tcl/linuxcnc.tcl
-	rm -rf src/autom4te.cache etc
-
-endif
-
-#	# Remove package artifacts
-	dh_clean
-
-install: build
-	dh_testdir
-	dh_testroot
-	dh_prep
-	dh_installdirs
-# start the install
-	mkdir -p debian/tmp
-	(cd debian/extras && cp -a * ../tmp)
-	(cd src; export DESTDIR=`pwd`/../debian/tmp; $(MAKE) V=$(DH_VERBOSE) $@)
-	mkdir -p debian/tmp/usr/lib debian/tmp/usr/include/linuxcnc
-	cp lib/*.a debian/tmp/usr/lib
-	## if they weren't there we don't care if rm fails
-	rm -f debian/tmp/usr/share/applications/linuxcnc-usermanual*.desktop
-	rm -f debian/tmp/usr/share/applications/linuxcnc-halmanual*.desktop
-	rm -f debian/tmp/usr/share/applications/linuxcnc-integratormanual*.desktop
-	rm -f debian/tmp/usr/share/applications/linuxcnc-gettingstarted*.desktop
-	rm -f debian/tmp/usr/share/applications/linuxcnc-developer*.desktop
-
-	rm -rf debian/tmp/usr/share/doc/linuxcnc/html
-	rm -f debian/tmp/usr/share/linuxcnc/examples/sample-configs/*/*position*.txt
-	# update emcweb.hal
-	sed 's/#NC_FILES_DIR/NC_FILES_DIR/' -i debian/tmp/usr/share/linuxcnc/examples/sample-configs/sim/emcweb.ini
-
-ifneq (,$(wildcard debian/machinekit-*-kernel-*.install))
-	mkdir -p debian/tmp/etc/udev/rules.d
-	cp src/rtapi/shmdrv/shmdrv.rules \
-	    debian/tmp/etc/udev/rules.d/50-shmdrv.rules
-endif
-	mkdir -p debian/tmp/etc/security/limits.d
-	cp src/rtapi/shmdrv/limits.d-machinekit.conf \
-	    debian/tmp/etc/security/limits.d/machinekit.conf
-
-	cp debian/machinekit-posix.install.in debian/machinekit-posix.install
-	cp debian/machinekit-rt-preempt.install.in debian/machinekit-rt-preempt.install
-	cp debian/machinekit-xenomai.install.in debian/machinekit-xenomai.install
-
-	if (grep ^USERMODE_PCI=yes src/Makefile.inc -q); then \
-	    echo "usr/include/linuxcnc/userpci/*.h" >> debian/machinekit-posix.install; \
-	    echo "usr/include/linuxcnc/userpci/*.h" >> debian/machinekit-rt-preempt.install; \
-	    echo "usr/include/linuxcnc/userpci/*.h" >> debian/machinekit-xenomai.install; \
-	fi
-
-	## only want this for armhf builds ##
-	if [ -f debian/platform_pc ] ; then \
-	    rm -f debian/platform_pc; \
-	else \
-	    mkdir -p debian/tmp/usr/lib/linuxcnc/prubin; \
-	    cp rtlib/prubin/* debian/tmp/usr/lib/linuxcnc/prubin; \
-	    cat debian/posix-postinst.add >> debian/machinekit-posix.postinst; \
-	    cat debian/rt-preempt-postinst.add >> debian/machinekit-rt-preempt.postinst; \
-	    cat debian/xenomai-postinst.add >> debian/machinekit-xenomai.postinst; \
-	    echo "usr/lib/linuxcnc/prubin/*" >> debian/machinekit-posix.install; \
-	    echo "usr/lib/linuxcnc/prubin/*" >> debian/machinekit-rt-preempt.install; \
-	    echo "usr/lib/linuxcnc/prubin/*" >> debian/machinekit-xenomai.install; \
-	fi
-
-
-	dh_install --sourcedir=debian/tmp --fail-missing -Xusr/bin/pasm
-
-# Build architecture-independent files here.
-binary-indep: build install
-# We have nothing to do by default.
-
-# Build architecture-dependent files here.
-binary-arch: build install
-	dh_testdir
-	dh_testroot
-	dh_installchangelogs
-	dh_installexamples
-	dh_installman
-	dh_installmime
-	dh_link
-	dh_strip
-	dh_compress -X.pdf -X.txt -X.hal -X.ini -X.clp -X.var -X.nml \
-	    -X.tbl -X.xml -Xsample-configs
-	dh_fixperms -X/linuxcnc_module_helper -X/rtapi_app_
-	dh_python2 --ignore-shebangs --no-guessing-versions --no-ext-rename
-	dh_makeshlibs
-	dh_installdeb
-
-#	# delete files that should be in machinekit-<flavor> package
-	rm -f debian/machinekit/usr/bin/comp
-	rm -f debian/machinekit/usr/share/linuxcnc/Makefile.modinc
-	rm -f debian/machinekit/usr/share/linuxcnc/Makefile.inc
-
-	cat debian/machinekit/DEBIAN/shlibs debian/shlibs.pre > \
-	    debian/shlibs.local
-        #enable buster builds to work with problematic shlib deps in current packages
-	dh_shlibdeps --dpkg-shlibdeps-params=--ignore-missing-info \
-            $(foreach p, $(SHLIBDEPS_X), -X $(p))
-	dh_gencontrol
-
-	dh_md5sums
-	dh_builddeb
-
-binary: binary-indep binary-arch
-.PHONY: build clean binary-indep binary-arch binary install
diff --git a/debian/xenomai-postinst.add b/debian/xenomai-postinst.add
deleted file mode 100644
index d895fb1..0000000
--- a/debian/xenomai-postinst.add
+++ /dev/null
@@ -1,13 +0,0 @@
-
-# ensure the links do not pre-exist, from previous installs.
-# or user work-arounds,  which will produce error messages
-rm -f /usr/lib/linuxcnc/xenomai/pru_generic.bin
-rm -f /usr/lib/linuxcnc/xenomai/pru_generic.dbg
-rm -f /usr/lib/linuxcnc/xenomai/pru_decamux.bin
-rm -f /usr/lib/linuxcnc/xenomai/pru_decamux.dbg
-
-# make symlinks to BBB pru_*.*
-ln -sf /usr/lib/linuxcnc/prubin/pru_generic.bin /usr/lib/linuxcnc/xenomai/pru_generic.bin
-ln -sf /usr/lib/linuxcnc/prubin/pru_generic.dbg /usr/lib/linuxcnc/xenomai/pru_generic.dbg
-ln -sf /usr/lib/linuxcnc/prubin/pru_decamux.bin /usr/lib/linuxcnc/xenomai/pru_decamux.bin
-ln -sf /usr/lib/linuxcnc/prubin/pru_decamux.dbg /usr/lib/linuxcnc/xenomai/pru_decamux.dbg
